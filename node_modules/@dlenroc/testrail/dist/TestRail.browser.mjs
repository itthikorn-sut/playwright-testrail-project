class t extends Error{constructor(t){super(t),this.name="TestRailException"}}async function e(t,e,n){var r;if(e&&(e.hasOwnProperty("limit")||e.hasOwnProperty("offset"))){const r=await n(e);return Array.isArray(r)?r:r[t]||[]}let i,u,s,o,a=0,h=0;const c=[],d=new Set;do{h=250*a++,i=await n({...e,limit:250,offset:h}),Array.isArray(i)?(o=!1,s=250===i.length,u=i):(o=!0,s=!!(null===(r=null==i?void 0:i._links)||void 0===r?void 0:r.next),u=i[t]||[]);for(const t of u)d.has(t.id)||(d.add(t.id),c.push(t),o=!0)}while(s&&o);return c}async function n(e,n,u,{query:s,json:o,form:a}={}){var h,c,d;const l={},f=e.baseURL+u+function(t){if(!t)return"";let e="";for(const[n,r]of Object.entries(t)){let t=r;"boolean"==typeof r?t=+r:Array.isArray(r)&&(t=r.join(",")),e+=`&${n}=${encodeURIComponent(t)}`}return e}(s);var _;let C;if(e.username&&e.password&&(l.Authorization=`Basic ${_=`${e.username}:${e.password}`,"undefined"!=typeof btoa?btoa(_):Buffer.from(_).toString("base64")}`),a||(l["Content-Type"]="application/json"),o)C=JSON.stringify(o);else if(a){C=new((null===(h=e.implementations)||void 0===h?void 0:h.FormData)||FormData);for(const[t,n]of Object.entries(a))n.name&&n.value?i(e,C,t,n.value,n.name):i(e,C,t,n)}for(;;){const i=await((null===(c=e.implementations)||void 0===c?void 0:c.fetch)||fetch)(f,{method:n,body:C,headers:l,signal:e.signal});if(429===i.status){const t=1e3*parseInt(i.headers.get("Retry-After")||"1");await r(t,e.signal);continue}if(409===i.status){await r(1e4,e.signal);continue}const u=(null===(d=i.headers.get("Content-Type"))||void 0===d?void 0:d.includes("json"))?await i.json().catch((()=>({}))):await i.blob();if(i.ok)return u;throw new t(u.error||`No additional error message received: ${i.status} ${i.statusText}`)}}function r(t,e){return(null==e?void 0:e.aborted)?Promise.reject(e.reason):new Promise(((n,r)=>{const i=setTimeout((()=>{n(),null==e||e.removeEventListener("abort",u)}),t);function u(){clearTimeout(i),r(null==e?void 0:e.reason)}null==e||e.addEventListener("abort",u,{once:!0})}))}function i(t,e,n,r,i){var u;try{e.append(n,r,i)}catch(s){const o=(null===(u=t.implementations)||void 0===u?void 0:u.Blob)||Blob,a=r instanceof o?r:new o([r]);e.append(n,a,i)}}class u{constructor(t){this.ctx={baseURL:((null==t?void 0:t.host)||"")+"/index.php?/api/v2/",...(null==t?void 0:t.user)&&{username:t.user},...(null==t?void 0:t.username)&&{username:t.username},...(null==t?void 0:t.password)&&{password:t.password},...(null==t?void 0:t.signal)&&{signal:t.signal},...(null==t?void 0:t.implementations)&&{implementations:t.implementations}}}addAttachmentToCase(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_attachment_to_case/${e}`,{form:{attachment:r}})}(r,t,e)))}addAttachmentToPlan(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_attachment_to_plan/${e}`,{form:{attachment:r}})}(r,t,e)))}addAttachmentToPlanEntry(t,e,r,i){return this.withCtx(i,(i=>function(t,e,r,i){return n(t,"POST",`add_attachment_to_plan_entry/${e}/${r}`,{form:{attachment:i}})}(i,t,e,r)))}addAttachmentToResult(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_attachment_to_result/${e}`,{form:{attachment:r}})}(r,t,e)))}addAttachmentToRun(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_attachment_to_run/${e}`,{form:{attachment:r}})}(r,t,e)))}getAttachmentsForCase(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("attachments",i,(e=>n(t,"GET",`get_attachments_for_case/${r}`,{query:e})))}(i,t,r)))}getAttachmentsForPlan(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("attachments",i,(e=>n(t,"GET",`get_attachments_for_plan/${r}`,{query:e})))}(i,t,r)))}getAttachmentsForPlanEntry(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"GET",`get_attachments_for_plan_entry/${e}/${r}`)}(r,t,e)))}getAttachmentsForRun(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("attachments",i,(e=>n(t,"GET",`get_attachments_for_run/${r}`,{query:e})))}(i,t,r)))}getAttachmentsForTest(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_attachments_for_test/${e}`)}(e,t)))}getAttachment(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_attachment/${e}`)}(e,t)))}deleteAttachment(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_attachment/${e}`)}(e,t)))}getBdd(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_bdd/${e}`)}(e,t)))}addBdd(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_bdd/${e}`,{form:{attachment:r}})}(r,t,e)))}getCase(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_case/${e}`)}(e,t)))}getCases(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("cases",i,(e=>n(t,"GET",`get_cases/${r}`,{query:e})))}(i,t,r)))}getHistoryForCase(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("history",i,(e=>n(t,"GET",`get_history_for_case/${r}`,{query:e})))}(i,t,r)))}addCase(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_case/${e}`,{json:r})}(r,t,e)))}copyCasesToSection(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`copy_cases_to_section/${e}`,{json:r})}(r,t,e)))}updateCase(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_case/${e}`,{json:r})}(r,t,e)))}updateCases(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_cases/${e}`,{json:r})}(r,t,e)))}moveCasesToSection(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`move_cases_to_section/${e}`,{json:r})}(r,t,e)))}deleteCase(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_case/${e}`)}(e,t)))}deleteCases(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`delete_cases/${e}`,{json:r})}(r,t,e)))}getCaseFields(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_case_fields")}(t)))}addCaseField(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST","add_case_field",{json:e})}(e,t)))}getCaseTypes(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_case_types")}(t)))}getConfigs(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_configs/${e}`)}(e,t)))}addConfigGroup(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_config_group/${e}`,{json:r})}(r,t,e)))}addConfig(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_config/${e}`,{json:r})}(r,t,e)))}updateConfigGroup(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_config_group/${e}`,{json:r})}(r,t,e)))}updateConfig(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_config/${e}`,{json:r})}(r,t,e)))}deleteConfigGroup(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_config_group/${e}`)}(e,t)))}deleteConfig(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_config/${e}`)}(e,t)))}getDataset(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_dataset/${e}`)}(e,t)))}getDatasets(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("datasets",i,(e=>n(t,"GET",`get_datasets/${r}`,{query:e})))}(i,t,r)))}addDataset(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_dataset/${e}`,{json:r})}(r,t,e)))}updateDataset(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_dataset/${e}`,{json:r})}(r,t,e)))}deleteDataset(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_dataset/${e}`)}(e,t)))}getGroup(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_group/${e}`)}(e,t)))}getGroups(t,r){return this.withCtx(r,(r=>function(t,r){return e("groups",r,(e=>n(t,"GET","get_groups",{query:e})))}(r,t)))}addGroup(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST","add_group",{json:e})}(e,t)))}updateGroup(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_group/${e}`,{json:r})}(r,t,e)))}deleteGroup(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_group/${e}`)}(e,t)))}getMilestone(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_milestone/${e}`)}(e,t)))}getMilestones(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("milestones",i,(e=>n(t,"GET",`get_milestones/${r}`,{query:e})))}(i,t,r)))}addMilestone(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_milestone/${e}`,{json:r})}(r,t,e)))}updateMilestone(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_milestone/${e}`,{json:r})}(r,t,e)))}deleteMilestone(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_milestone/${e}`)}(e,t)))}getPlan(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_plan/${e}`)}(e,t)))}getPlans(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("plans",i,(e=>n(t,"GET",`get_plans/${r}`,{query:e})))}(i,t,r)))}addPlan(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_plan/${e}`,{json:r})}(r,t,e)))}addPlanEntry(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_plan_entry/${e}`,{json:r})}(r,t,e)))}addRunToPlanEntry(t,e,r,i){return this.withCtx(i,(i=>function(t,e,r,i){return n(t,"POST",`add_run_to_plan_entry/${e}/${r}`,{json:i})}(i,t,e,r)))}updatePlan(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_plan/${e}`,{json:r})}(r,t,e)))}updatePlanEntry(t,e,r,i){return this.withCtx(i,(i=>function(t,e,r,i){return n(t,"POST",`update_plan_entry/${e}/${r}`,{json:i})}(i,t,e,r)))}updateRunInPlanEntry(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_run_in_plan_entry/${e}`,{json:r})}(r,t,e)))}closePlan(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`close_plan/${e}`)}(e,t)))}deletePlan(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_plan/${e}`)}(e,t)))}deletePlanEntry(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`delete_plan_entry/${e}/${r}`)}(r,t,e)))}deleteRunFromPlanEntry(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_run_from_plan_entry/${e}`)}(e,t)))}getPriorities(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_priorities")}(t)))}getProject(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_project/${e}`)}(e,t)))}getProjects(t,r){return this.withCtx(r,(r=>function(t,r){return e("projects",r,(e=>n(t,"GET","get_projects",{query:e})))}(r,t)))}addProject(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST","add_project",{json:e})}(e,t)))}updateProject(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_project/${e}`,{json:r})}(r,t,e)))}deleteProject(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_project/${e}`)}(e,t)))}getReports(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_reports/${e}`)}(e,t)))}runReport(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`run_report/${e}`)}(e,t)))}getResults(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("results",i,(e=>n(t,"GET",`get_results/${r}`,{query:e})))}(i,t,r)))}getResultsForCase(t,r,i,u){return this.withCtx(u,(u=>function(t,r,i,u){return e("results",u,(e=>n(t,"GET",`get_results_for_case/${r}/${i}`,{query:e})))}(u,t,r,i)))}getResultsForRun(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("results",i,(e=>n(t,"GET",`get_results_for_run/${r}`,{query:e})))}(i,t,r)))}addResult(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_result/${e}`,{json:r})}(r,t,e)))}addResultForCase(t,e,r,i){return this.withCtx(i,(i=>function(t,e,r,i){return n(t,"POST",`add_result_for_case/${e}/${r}`,{json:i})}(i,t,e,r)))}addResults(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_results/${e}`,{json:r})}(r,t,e)))}addResultsForCases(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_results_for_cases/${e}`,{json:r})}(r,t,e)))}getResultFields(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_result_fields")}(t)))}getRoles(t,r){return this.withCtx(r,(r=>function(t,r){return e("roles",r,(e=>n(t,"GET","get_roles",{query:e})))}(r,t)))}getRun(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_run/${e}`)}(e,t)))}getRuns(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("runs",i,(e=>n(t,"GET",`get_runs/${r}`,{query:e})))}(i,t,r)))}addRun(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_run/${e}`,{json:r})}(r,t,e)))}updateRun(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_run/${e}`,{json:r})}(r,t,e)))}closeRun(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`close_run/${e}`)}(e,t)))}deleteRun(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_run/${e}`)}(e,t)))}getSection(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_section/${e}`)}(e,t)))}getSections(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("sections",i,(e=>n(t,"GET",`get_sections/${r}`,{query:e})))}(i,t,r)))}addSection(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_section/${e}`,{json:r})}(r,t,e)))}moveSection(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`move_section/${e}`,{json:r})}(r,t,e)))}updateSection(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_section/${e}`,{json:r})}(r,t,e)))}deleteSection(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_section/${e}`)}(e,t)))}getSharedStep(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_shared_step/${e}`)}(e,t)))}getSharedSteps(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("shared_steps",i,(e=>n(t,"GET",`get_shared_steps/${r}`,{query:e})))}(i,t,r)))}getSharedStepHistory(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("step_history",i,(e=>n(t,"GET",`get_shared_step_history/${r}`,{query:e})))}(i,t,r)))}addSharedStep(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_shared_step/${e}`,{json:r})}(r,t,e)))}updateSharedStep(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_shared_step/${e}`,{json:r})}(r,t,e)))}deleteSharedStep(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`delete_shared_step/${e}`,{json:r})}(r,t,e)))}getStatuses(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_statuses")}(t)))}getCaseStatuses(t,r){return this.withCtx(r,(r=>function(t,r){return e("case_statuses",r,(e=>n(t,"GET","get_case_statuses",{query:e})))}(r,t)))}getSuite(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_suite/${e}`)}(e,t)))}getSuites(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_suites/${e}`)}(e,t)))}addSuite(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_suite/${e}`,{json:r})}(r,t,e)))}updateSuite(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_suite/${e}`,{json:r})}(r,t,e)))}deleteSuite(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_suite/${e}`)}(e,t)))}getTemplates(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_templates/${e}`)}(e,t)))}getTest(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_test/${e}`)}(e,t)))}getTests(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("tests",i,(e=>n(t,"GET",`get_tests/${r}`,{query:e})))}(i,t,r)))}getUser(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET",`get_user/${e}`)}(e,t)))}getCurrentUser(t){return this.withCtx(t,(t=>function(t){return n(t,"GET","get_current_user")}(t)))}getUserByEmail(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET","get_user_by_email",{query:{email:e}})}(e,t)))}getUsers(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"GET","get_users",{query:e})}(e,t)))}addUser(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST","add_user",{json:e})}(e,t)))}updateUser(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_user/${e}`,{json:r})}(r,t,e)))}getVariables(t,r,i){return this.withCtx(i,(i=>function(t,r,i){return e("variables",i,(e=>n(t,"GET",`get_variables/${r}`,{query:e})))}(i,t,r)))}addVariable(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`add_variable/${e}`,{json:r})}(r,t,e)))}updateVariable(t,e,r){return this.withCtx(r,(r=>function(t,e,r){return n(t,"POST",`update_variable/${e}`,{json:r})}(r,t,e)))}deleteVariable(t,e){return this.withCtx(e,(e=>function(t,e){return n(t,"POST",`delete_variable/${e}`)}(e,t)))}withCtx(t,e){var n;const r=this.ctx.signal,i=null==t?void 0:t.signal;if(!i)return e(this.ctx);if(!r)return e(Object.assign({},this.ctx,{signal:t.signal}));if(r.aborted||i.aborted)return Promise.reject(r.reason||t.signal.reason);const u=new((null===(n=this.ctx.implementations)||void 0===n?void 0:n.AbortController)||AbortController),s=()=>{r.removeEventListener("abort",o),i.removeEventListener("abort",o)},o=()=>{s(),u.abort(r.reason||i.reason)};return r.addEventListener("abort",o),i.addEventListener("abort",o),e(Object.assign({},this.ctx,{signal:u.signal})).then((t=>(s(),t)),(t=>{throw s(),t}))}}u.Exception=t;export{u as default};
//# sourceMappingURL=TestRail.browser.mjs.map
